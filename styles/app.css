:root {
  --bg: #0c0f14;
  --fg: #dbe3f1;
  --muted: #93a0b5;
  --accent: #00adff;

  --panel-bg: #121720;
  --panel-border: #1f2a3a;
  --panel-shadow: 0 8px 24px rgba(0,0,0,.35);

  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);

  /* layout breakpoints */
  --desktop-break: 900px;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: rgba(0,0,0,0); }
html, body { height: 100%; margin: 0; background: var(--bg); color: var(--fg);
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  overscroll-behavior: contain;
}

/* --- New app layout container --- */
#app {
  position: fixed;
  inset: 0;
  display: grid;
  grid-template-areas:
    "scene"
    "panel";
  grid-template-rows: 55vh 1fr;   /* mobile-first: scene on top, panel bottom */
  grid-template-columns: 1fr;
  padding-left:  max(8px, var(--safe-left));
  padding-right: max(8px, var(--safe-right));
}

/* Scene host controls canvas size */
#sceneHost {
  grid-area: scene;
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
}

/* Canvas fills its host (no fixed inset anymore) */
#c {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  outline: none;
  touch-action: none;
  z-index: 0;
}

/* Panel: mobile bottom, fixed height via grid row */
#panel.card {
  grid-area: panel;
  position: relative;
  z-index: 10;
  pointer-events: auto;

  background: var(--panel-bg);
  border: 1px solid var(--panel-border);
  border-radius: 16px;
  box-shadow: var(--panel-shadow);
  padding: 0;
  overflow: hidden;

  /* keep internal sizing from your original */
  --tabbar-h: 48px;
}

/* Tab bar docked to TOP of panel */
#panel .tabs {
  height: var(--tabbar-h);
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  border-bottom: 1px solid var(--panel-border);
  background: #0f1621;
}
#panel .tab {
  min-height: var(--tabbar-h);
  height: var(--tabbar-h);
  padding: 0 8px;
  background: transparent;
  border: 0;
  color: var(--muted);
  font-weight: 700;
  font-size: 15px;
}
#panel .tab.on { color: var(--fg); background: #0b1220; }
#panel .tab:active { transform: translateY(1px); }

/* Tab content area fills below the tab bar and is scrollable */
#panel .tabcontent {
  display: none;
  position: absolute;
  left: 0; right: 0;
  top: var(--tabbar-h);
  bottom: 0;
  padding: 12px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}
#panel .tabcontent.on { display: block; }

/* ===== Form controls (unchanged) ===== */
.section { margin-bottom: 12px; }
.section.muted { color: var(--muted); }
.row { display:flex; align-items:center; gap:12px; margin:12px 0; }
.row-split { justify-content: space-between; }
label { color: var(--muted); font-size: 14px; }
.input-pair { display:flex; align-items:center; gap:10px; }

input[type="number"], input[type="text"], input[type="decimal"] {
  width: 108px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--panel-border);
  background: #0f1621;
  color: var(--fg);
  font-size: 16px;
  -webkit-appearance: none;
  appearance: none;
}
.times { color: var(--muted); }

input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input[type=number] { -moz-appearance: textfield; }

/* Spinners */
.spinner { display:flex; align-items:center; gap:10px; }
.spinner input {
  width: 104px; padding: 10px 12px; border-radius:12px;
  border: 1px solid var(--panel-border); background:#0f1621; color:var(--fg);
  text-align:center; font-size:16px;
}
.spinner button {
  width: 44px; height: 44px;
  border-radius:12px;
  border:1px solid var(--panel-border);
  background:#18202d; color:var(--fg); font-weight:800; font-size:18px;
}

/* Buttons */
button, .pill {
  min-height: 44px;
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid var(--panel-border);
  background: #18202d;
  color: var(--fg);
  font-weight: 600;
  font-size: 16px;
}
button:active, .pill:active { transform: translateY(1px); }
button.primary { background: linear-gradient(180deg, #00adff, #007ee0); border-color: #006cbf; color: white; }
button.toggle.on { outline: 2px solid var(--accent); outline-offset: 0; }

/* Grids */
.grid { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }

/* Sculpt switch */
.switch { position: relative; display: inline-block; width: 56px; height: 32px; }
.switch input { display:none; }
.slider { position: absolute; cursor: pointer; inset: 0; background:#2a2f3a; border-radius: 999px; transition: .2s; }
.slider:before { content:""; position:absolute; width:26px; height:26px; left:3px; top:3px; background:#fff; border-radius:50%; transition:.2s; }
.switch input:checked + .slider { background: #1f8ae6; }
.switch input:checked + .slider:before { transform: translateX(24px); }

.hint { margin: 8px 4px 0; color: var(--muted); font-size: 12px; }

/* Touch tweaks */
@media (hover: none) and (pointer: coarse) {
  .tab { font-size: 16px; }
  .grid { gap:12px; }
  .row { gap:14px; }
}

/* Ensure panel capture taps */
#panel { touch-action: manipulation; pointer-events: auto; }

/* Texture Palette */
.texture-palette {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
  gap: 10px;
  margin: 12px 0;
}
.texture-palette .tex-btn {
  font-size: 15px;
  background-color: #18202d;
  border-color: var(--panel-border);
}
.texture-palette .tex-btn.on {
  outline: 2px solid var(--accent);
  outline-offset: 0;
  background: #2a3a50;
}

/* ===== Desktop layout: scene left (> half), panel fixed right ===== */
@media (min-width: var(--desktop-break)) {
  #app {
    grid-template-areas: "scene panel";
    grid-template-rows: 1fr;
    grid-template-columns: minmax(640px, 58vw) 1fr; /* left stays just over half */
    padding-left:  max(12px, var(--safe-left));
    padding-right: max(12px, var(--safe-right));
  }

  #sceneHost {
    border-radius: 14px;
  }

  #panel.card {
    position: sticky; /* stick within grid column */
    top: max(8px, var(--safe-top));
    height: calc(100vh - max(8px, var(--safe-top)) - max(8px, var(--safe-bottom)));
    border-radius: 16px;
  }
}
